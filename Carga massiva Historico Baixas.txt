USE [CTN_PRODUCAO]
GO
SET IDENTITY_INSERT HISTORICO_BAIXA_LANCAMENTO ON
GO
INSERT INTO HISTORICO_BAIXA_LANCAMENTO with (TABLOCK) ( ID_LANCAMENTO, ID_CONTRATO, ID_FORMA_RECEBIMENTO, NUMERO_DOC, COD_BARRA, IPTE, CNAB, PAGREC, STATUS_LAN, HISTORICO, DT_CRIACAO, DT_VENCIMENTO, DT_EMISSAO, DT_BAIXA, DT_PREV_BAIXA, DT_CANCELAMENTO, DT_MES_ANO_COMPETENCIA, VALOR_ORIGINAL_SERVICO, VALOR_BAIXADO, VALOR_JUROS, VALOR_MULTA, VALOR_DESCONTO, ID_USUARIO_BAIXA, DT_ALTERACAO, ID_USUARIO_SISTEMA, NUM_PARCELA, NUMATRICULA, NOME_ARQUIVO, CARTEIRA, VL_TARIFA, cod_ocorrencia, ID_EXPORTADO_CAIXA, FLAG_ENVIO, FLAG_FATURAMENTO, FLAG_BAIXA, FLAG_REFATURAMENTO, DT_REFATURAMENTO, FLAG_INRREGULAR, DT_FATURAMENTO, DT_INRREGULAR, FLAG_ACUMULADO, DT_TERMINO_ENVIO, ID_USUARIO_CANCELAMENTO, DATA_VENDA, TID_MAIS_TODOS, NSU  ) 
SELECT * from Lancamento L (nolock) where   CONVERT( DATE, L.DT_BAIXA ) >  CONVERT( DATE, DATEADD ( DAY ,-91, GETDATE ( ) ) ) 
and NOT EXISTS(select top 1 H.ID_LANCAMENTO from HISTORICO_BAIXA_LANCAMENTO H (nolock) where H.ID_LANCAMENTO = L.ID_LANCAMENTO)
GO
SET IDENTITY_INSERT HISTORICO_BAIXA_LANCAMENTO OFF
GO

USE [CTN_PRODUCAO]
GO
SET IDENTITY_INSERT HISTORICO_BAIXA_LANCAMENTO ON
GO
INSERT INTO HISTORICO_BAIXA_LANCAMENTO with (TABLOCK) ( ID_LANCAMENTO, ID_CONTRATO, ID_FORMA_RECEBIMENTO, NUMERO_DOC, COD_BARRA, IPTE, CNAB, PAGREC, STATUS_LAN, HISTORICO, DT_CRIACAO, DT_VENCIMENTO, DT_EMISSAO, DT_BAIXA, DT_PREV_BAIXA, DT_CANCELAMENTO, DT_MES_ANO_COMPETENCIA, VALOR_ORIGINAL_SERVICO, VALOR_BAIXADO, VALOR_JUROS, VALOR_MULTA, VALOR_DESCONTO, ID_USUARIO_BAIXA, DT_ALTERACAO, ID_USUARIO_SISTEMA, NUM_PARCELA, NUMATRICULA, NOME_ARQUIVO, CARTEIRA, VL_TARIFA, cod_ocorrencia, ID_EXPORTADO_CAIXA, FLAG_ENVIO, FLAG_FATURAMENTO, FLAG_BAIXA, FLAG_REFATURAMENTO, DT_REFATURAMENTO, FLAG_INRREGULAR, DT_FATURAMENTO, DT_INRREGULAR, FLAG_ACUMULADO, DT_TERMINO_ENVIO, ID_USUARIO_CANCELAMENTO, DATA_VENDA, TID_MAIS_TODOS, NSU  ) 
SELECT * from Lancamento L (nolock) where   CONVERT( DATE, L.DT_BAIXA ) >  CONVERT( DATE, DATEADD ( DAY ,-181, GETDATE ( ) ) ) and CONVERT( DATE, L.DT_BAIXA ) <  CONVERT( DATE, DATEADD ( DAY ,-90, GETDATE ( ) ) )
and NOT EXISTS(select top 1 H.ID_LANCAMENTO from HISTORICO_BAIXA_LANCAMENTO H (nolock) where H.ID_LANCAMENTO = L.ID_LANCAMENTO)
GO
SET IDENTITY_INSERT HISTORICO_BAIXA_LANCAMENTO OFF
GO

USE [CTN_PRODUCAO]
GO
SET IDENTITY_INSERT HISTORICO_BAIXA_LANCAMENTO ON
GO
INSERT INTO HISTORICO_BAIXA_LANCAMENTO with (TABLOCK) ( ID_LANCAMENTO, ID_CONTRATO, ID_FORMA_RECEBIMENTO, NUMERO_DOC, COD_BARRA, IPTE, CNAB, PAGREC, STATUS_LAN, HISTORICO, DT_CRIACAO, DT_VENCIMENTO, DT_EMISSAO, DT_BAIXA, DT_PREV_BAIXA, DT_CANCELAMENTO, DT_MES_ANO_COMPETENCIA, VALOR_ORIGINAL_SERVICO, VALOR_BAIXADO, VALOR_JUROS, VALOR_MULTA, VALOR_DESCONTO, ID_USUARIO_BAIXA, DT_ALTERACAO, ID_USUARIO_SISTEMA, NUM_PARCELA, NUMATRICULA, NOME_ARQUIVO, CARTEIRA, VL_TARIFA, cod_ocorrencia, ID_EXPORTADO_CAIXA, FLAG_ENVIO, FLAG_FATURAMENTO, FLAG_BAIXA, FLAG_REFATURAMENTO, DT_REFATURAMENTO, FLAG_INRREGULAR, DT_FATURAMENTO, DT_INRREGULAR, FLAG_ACUMULADO, DT_TERMINO_ENVIO, ID_USUARIO_CANCELAMENTO, DATA_VENDA, TID_MAIS_TODOS, NSU  ) 
SELECT * from Lancamento L (nolock) where   CONVERT( DATE, L.DT_BAIXA ) >  CONVERT( DATE, DATEADD ( DAY ,-271, GETDATE ( ) ) ) and CONVERT( DATE, L.DT_BAIXA ) <  CONVERT( DATE, DATEADD ( DAY ,-180, GETDATE ( ) ) )
and NOT EXISTS(select top 1 H.ID_LANCAMENTO from HISTORICO_BAIXA_LANCAMENTO H (nolock) where H.ID_LANCAMENTO = L.ID_LANCAMENTO)
GO
SET IDENTITY_INSERT HISTORICO_BAIXA_LANCAMENTO OFF
GO

USE [CTN_PRODUCAO]
GO
SET IDENTITY_INSERT HISTORICO_BAIXA_LANCAMENTO ON
GO
INSERT INTO HISTORICO_BAIXA_LANCAMENTO with (TABLOCK) ( ID_LANCAMENTO, ID_CONTRATO, ID_FORMA_RECEBIMENTO, NUMERO_DOC, COD_BARRA, IPTE, CNAB, PAGREC, STATUS_LAN, HISTORICO, DT_CRIACAO, DT_VENCIMENTO, DT_EMISSAO, DT_BAIXA, DT_PREV_BAIXA, DT_CANCELAMENTO, DT_MES_ANO_COMPETENCIA, VALOR_ORIGINAL_SERVICO, VALOR_BAIXADO, VALOR_JUROS, VALOR_MULTA, VALOR_DESCONTO, ID_USUARIO_BAIXA, DT_ALTERACAO, ID_USUARIO_SISTEMA, NUM_PARCELA, NUMATRICULA, NOME_ARQUIVO, CARTEIRA, VL_TARIFA, cod_ocorrencia, ID_EXPORTADO_CAIXA, FLAG_ENVIO, FLAG_FATURAMENTO, FLAG_BAIXA, FLAG_REFATURAMENTO, DT_REFATURAMENTO, FLAG_INRREGULAR, DT_FATURAMENTO, DT_INRREGULAR, FLAG_ACUMULADO, DT_TERMINO_ENVIO, ID_USUARIO_CANCELAMENTO, DATA_VENDA, TID_MAIS_TODOS, NSU  ) 
SELECT * from Lancamento L (nolock) where   CONVERT( DATE, L.DT_BAIXA ) >  CONVERT( DATE, DATEADD ( DAY ,-361, GETDATE ( ) ) ) and CONVERT( DATE, L.DT_BAIXA ) <  CONVERT( DATE, DATEADD ( DAY ,-270, GETDATE ( ) ) )
and NOT EXISTS(select top 1 H.ID_LANCAMENTO from HISTORICO_BAIXA_LANCAMENTO H (nolock) where H.ID_LANCAMENTO = L.ID_LANCAMENTO)
GO
SET IDENTITY_INSERT HISTORICO_BAIXA_LANCAMENTO OFF
GO

USE [CTN_PRODUCAO]
GO
SET IDENTITY_INSERT HISTORICO_BAIXA_LANCAMENTO ON
GO
INSERT INTO HISTORICO_BAIXA_LANCAMENTO with (TABLOCK) ( ID_LANCAMENTO, ID_CONTRATO, ID_FORMA_RECEBIMENTO, NUMERO_DOC, COD_BARRA, IPTE, CNAB, PAGREC, STATUS_LAN, HISTORICO, DT_CRIACAO, DT_VENCIMENTO, DT_EMISSAO, DT_BAIXA, DT_PREV_BAIXA, DT_CANCELAMENTO, DT_MES_ANO_COMPETENCIA, VALOR_ORIGINAL_SERVICO, VALOR_BAIXADO, VALOR_JUROS, VALOR_MULTA, VALOR_DESCONTO, ID_USUARIO_BAIXA, DT_ALTERACAO, ID_USUARIO_SISTEMA, NUM_PARCELA, NUMATRICULA, NOME_ARQUIVO, CARTEIRA, VL_TARIFA, cod_ocorrencia, ID_EXPORTADO_CAIXA, FLAG_ENVIO, FLAG_FATURAMENTO, FLAG_BAIXA, FLAG_REFATURAMENTO, DT_REFATURAMENTO, FLAG_INRREGULAR, DT_FATURAMENTO, DT_INRREGULAR, FLAG_ACUMULADO, DT_TERMINO_ENVIO, ID_USUARIO_CANCELAMENTO, DATA_VENDA, TID_MAIS_TODOS, NSU  ) 
SELECT * from Lancamento L (nolock) where   CONVERT( DATE, L.DT_BAIXA ) >  CONVERT( DATE, DATEADD ( DAY ,-451, GETDATE ( ) ) ) and CONVERT( DATE, L.DT_BAIXA ) <  CONVERT( DATE, DATEADD ( DAY ,-360, GETDATE ( ) ) )
and NOT EXISTS(select top 1 H.ID_LANCAMENTO from HISTORICO_BAIXA_LANCAMENTO H (nolock) where H.ID_LANCAMENTO = L.ID_LANCAMENTO)
GO
SET IDENTITY_INSERT HISTORICO_BAIXA_LANCAMENTO OFF
GO

USE [CTN_PRODUCAO]
GO
SET IDENTITY_INSERT HISTORICO_BAIXA_LANCAMENTO ON
GO
INSERT INTO HISTORICO_BAIXA_LANCAMENTO with (TABLOCK) ( ID_LANCAMENTO, ID_CONTRATO, ID_FORMA_RECEBIMENTO, NUMERO_DOC, COD_BARRA, IPTE, CNAB, PAGREC, STATUS_LAN, HISTORICO, DT_CRIACAO, DT_VENCIMENTO, DT_EMISSAO, DT_BAIXA, DT_PREV_BAIXA, DT_CANCELAMENTO, DT_MES_ANO_COMPETENCIA, VALOR_ORIGINAL_SERVICO, VALOR_BAIXADO, VALOR_JUROS, VALOR_MULTA, VALOR_DESCONTO, ID_USUARIO_BAIXA, DT_ALTERACAO, ID_USUARIO_SISTEMA, NUM_PARCELA, NUMATRICULA, NOME_ARQUIVO, CARTEIRA, VL_TARIFA, cod_ocorrencia, ID_EXPORTADO_CAIXA, FLAG_ENVIO, FLAG_FATURAMENTO, FLAG_BAIXA, FLAG_REFATURAMENTO, DT_REFATURAMENTO, FLAG_INRREGULAR, DT_FATURAMENTO, DT_INRREGULAR, FLAG_ACUMULADO, DT_TERMINO_ENVIO, ID_USUARIO_CANCELAMENTO, DATA_VENDA, TID_MAIS_TODOS, NSU  ) 
SELECT * from Lancamento L (nolock) where   CONVERT( DATE, L.DT_BAIXA ) >  CONVERT( DATE, DATEADD ( DAY ,-541, GETDATE ( ) ) ) and CONVERT( DATE, L.DT_BAIXA ) <  CONVERT( DATE, DATEADD ( DAY ,-450, GETDATE ( ) ) )
and NOT EXISTS(select top 1 H.ID_LANCAMENTO from HISTORICO_BAIXA_LANCAMENTO H (nolock) where H.ID_LANCAMENTO = L.ID_LANCAMENTO)
GO
SET IDENTITY_INSERT HISTORICO_BAIXA_LANCAMENTO OFF
GO

USE [CTN_PRODUCAO]
GO
SET IDENTITY_INSERT HISTORICO_BAIXA_LANCAMENTO ON
GO
INSERT INTO HISTORICO_BAIXA_LANCAMENTO with (TABLOCK) ( ID_LANCAMENTO, ID_CONTRATO, ID_FORMA_RECEBIMENTO, NUMERO_DOC, COD_BARRA, IPTE, CNAB, PAGREC, STATUS_LAN, HISTORICO, DT_CRIACAO, DT_VENCIMENTO, DT_EMISSAO, DT_BAIXA, DT_PREV_BAIXA, DT_CANCELAMENTO, DT_MES_ANO_COMPETENCIA, VALOR_ORIGINAL_SERVICO, VALOR_BAIXADO, VALOR_JUROS, VALOR_MULTA, VALOR_DESCONTO, ID_USUARIO_BAIXA, DT_ALTERACAO, ID_USUARIO_SISTEMA, NUM_PARCELA, NUMATRICULA, NOME_ARQUIVO, CARTEIRA, VL_TARIFA, cod_ocorrencia, ID_EXPORTADO_CAIXA, FLAG_ENVIO, FLAG_FATURAMENTO, FLAG_BAIXA, FLAG_REFATURAMENTO, DT_REFATURAMENTO, FLAG_INRREGULAR, DT_FATURAMENTO, DT_INRREGULAR, FLAG_ACUMULADO, DT_TERMINO_ENVIO, ID_USUARIO_CANCELAMENTO, DATA_VENDA, TID_MAIS_TODOS, NSU  ) 
SELECT * from Lancamento L (nolock) where   CONVERT( DATE, L.DT_BAIXA ) >  CONVERT( DATE, DATEADD ( DAY ,-631, GETDATE ( ) ) ) and CONVERT( DATE, L.DT_BAIXA ) <  CONVERT( DATE, DATEADD ( DAY ,-540, GETDATE ( ) ) )
and NOT EXISTS(select top 1 H.ID_LANCAMENTO from HISTORICO_BAIXA_LANCAMENTO H (nolock) where H.ID_LANCAMENTO = L.ID_LANCAMENTO)
GO
SET IDENTITY_INSERT HISTORICO_BAIXA_LANCAMENTO OFF
GO

USE [CTN_PRODUCAO]
GO
SET IDENTITY_INSERT HISTORICO_BAIXA_LANCAMENTO ON
GO
INSERT INTO HISTORICO_BAIXA_LANCAMENTO with (TABLOCK) ( ID_LANCAMENTO, ID_CONTRATO, ID_FORMA_RECEBIMENTO, NUMERO_DOC, COD_BARRA, IPTE, CNAB, PAGREC, STATUS_LAN, HISTORICO, DT_CRIACAO, DT_VENCIMENTO, DT_EMISSAO, DT_BAIXA, DT_PREV_BAIXA, DT_CANCELAMENTO, DT_MES_ANO_COMPETENCIA, VALOR_ORIGINAL_SERVICO, VALOR_BAIXADO, VALOR_JUROS, VALOR_MULTA, VALOR_DESCONTO, ID_USUARIO_BAIXA, DT_ALTERACAO, ID_USUARIO_SISTEMA, NUM_PARCELA, NUMATRICULA, NOME_ARQUIVO, CARTEIRA, VL_TARIFA, cod_ocorrencia, ID_EXPORTADO_CAIXA, FLAG_ENVIO, FLAG_FATURAMENTO, FLAG_BAIXA, FLAG_REFATURAMENTO, DT_REFATURAMENTO, FLAG_INRREGULAR, DT_FATURAMENTO, DT_INRREGULAR, FLAG_ACUMULADO, DT_TERMINO_ENVIO, ID_USUARIO_CANCELAMENTO, DATA_VENDA, TID_MAIS_TODOS, NSU  ) 
SELECT * from Lancamento L (nolock) where   CONVERT( DATE, L.DT_BAIXA ) >  CONVERT( DATE, DATEADD ( DAY ,-721, GETDATE ( ) ) ) and CONVERT( DATE, L.DT_BAIXA ) <  CONVERT( DATE, DATEADD ( DAY ,-630, GETDATE ( ) ) )
and NOT EXISTS(select top 1 H.ID_LANCAMENTO from HISTORICO_BAIXA_LANCAMENTO H (nolock) where H.ID_LANCAMENTO = L.ID_LANCAMENTO)
GO
SET IDENTITY_INSERT HISTORICO_BAIXA_LANCAMENTO OFF
GO


